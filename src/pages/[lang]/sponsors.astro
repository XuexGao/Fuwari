---
import { siteConfig } from "@/config";
import type { Sponsor } from "@/types/data";
import LinkSubmitInfo from "@components/misc/LinkSubmitInfo.astro";
import MainGridLayout from "@layouts/MainGridLayout.astro";
import { Icon } from "astro-icon/components";
import I18n from "@components/I18n.astro";
import { Translation, i18n } from "@/i18n/translation";

export async function getStaticPaths() {
	return [
		{ params: { lang: 'zh-cn' } },
		{ params: { lang: 'en' } },
	];
}

const { lang } = Astro.params;

const sponsors = Object.values(
	import.meta.glob<Sponsor>("@/data/sponsors/*.json", {
		eager: true,
		import: "default",
	}),
);

const breadcrumbSchema = {
	"@context": "https://schema.org",
	"@type": "BreadcrumbList",
	itemListElement: [
		{
			"@type": "ListItem",
			position: 1,
			name: i18n(Translation.Home, lang === 'zh-cn' ? 'zh_CN' : 'en'),
			item: Astro.site,
		},
		{
			"@type": "ListItem",
			position: 2,
			name: i18n(Translation.Sponsors, lang === 'zh-cn' ? 'zh_CN' : 'en'),
			item: new URL("/sponsors", Astro.site).toString(),
		},
	],
};
---

<MainGridLayout title={i18n(Translation.Sponsors, lang === 'zh-cn' ? 'zh_CN' : 'en')} lang={lang === 'zh-cn' ? 'zh_CN' : 'en'}>
    <script is:inline slot="head" type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)}></script>
    <div class="card-base p-6 md:p-8">
        <div class="flex items-center gap-2 mb-6">
            <div class="h-8 w-8 rounded-lg bg-[var(--primary)] flex items-center justify-center text-white dark:text-black/70">
                <Icon name="material-symbols:favorite" class="text-[1.5rem]" />
            </div>
            <h1 class="text-2xl font-bold text-black dark:text-white"><I18n key={Translation.Sponsors} /></h1>
        </div>

        <div class="mb-6">
            <p class="text-lg text-black/80 dark:text-white/80 mb-3">
                <I18n key={Translation.SponsorHelp} />
            </p>
            <p class="text-sm text-black/60 dark:text-white/60">
                <I18n key={Translation.SponsorUsage} />
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6 max-w-4xl mx-auto">
            <!-- Alipay -->
            <div class="donate-card">
                <div class="flex items-center gap-3 mb-4">
                    <div class="h-10 w-10 rounded-lg bg-blue-500 flex items-center justify-center">
                        <Icon name="simple-icons:alipay" class="text-[1.5rem] text-white" />
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-black dark:text-white"><I18n key={Translation.Alipay} /></h3>
                        <p class="text-sm text-black/60 dark:text-white/60"><I18n key={Translation.ScanToPay} /></p>
                    </div>
                </div>
                <div class="qr-code-placeholder">
                    <div class="relative w-48 h-48 mx-auto rounded-lg overflow-hidden" style={`--theme-hue: ${siteConfig.themeColor.hue}`}>
                        <img src="/sponsors/alipay.svg" alt="Alipay QR Code" class="w-full h-full object-cover transition duration-500" />
                    </div>
                </div>
            </div>

            <!-- WeChat Pay -->
            <div class="donate-card">
                <div class="flex items-center gap-3 mb-4">
                    <div class="h-10 w-10 rounded-lg bg-green-500 flex items-center justify-center">
                        <Icon name="simple-icons:wechat" class="text-[1.5rem] text-white" />
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-black dark:text-white"><I18n key={Translation.WechatPay} /></h3>
                        <p class="text-sm text-black/60 dark:text-white/60"><I18n key={Translation.ScanToPay} /></p>
                    </div>
                </div>
                <div class="qr-code-placeholder">
                    <div class="relative w-48 h-48 mx-auto rounded-lg overflow-hidden" style={`--theme-hue: ${siteConfig.themeColor.hue}`}>
                        <img src="/sponsors/wechat.svg" alt="WeChat Pay QR Code" class="w-full h-full object-cover transition duration-500" />
                    </div>
                </div>
            </div>

            
            </div>
        </div>

        <br>

        <!-- Other ways to support -->
        <div class="card-base p-6 mb-6">
            <h2 class="text-xl font-bold text-black dark:text-white mb-3"><I18n key={Translation.OtherSupport} /></h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="support-card">
                    <div class="flex items-center gap-2 mb-2">
                        <Icon name="material-symbols:share" class="text-[1.2rem] text-[var(--primary)]" />
                        <span class="font-semibold text-black dark:text-white"><I18n key={Translation.ShareRecommend} /></span>
                    </div>
                    <p class="text-sm text-black/60 dark:text-white/60">
                        <I18n key={Translation.ShareDescription} />
                    </p>
                </div>

                <div class="support-card">
                    <div class="flex items-center gap-2 mb-2">
                        <Icon name="material-symbols:comment" class="text-[1.2rem] text-[var(--primary)]" />
                        <span class="font-semibold text-black dark:text-white"><I18n key={Translation.CommentInteraction} /></span>
                    </div>
                    <p class="text-sm text-black/60 dark:text-white/60">
                        <I18n key={Translation.CommentDescription} />
                    </p>
                </div>

                <div class="support-card">
                    <div class="flex items-center gap-2 mb-2">
                        <Icon name="material-symbols:star" class="text-[1.2rem] text-[var(--primary)]" />
                        <span class="font-semibold text-black dark:text-white"><I18n key={Translation.FollowSubscribe} /></span>
                    </div>
                    <p class="text-sm text-black/60 dark:text-white/60">
                        <I18n key={Translation.FollowDescription} />
                    </p>
                </div>
            </div>
        </div>
        <div class="sponsors-section card-base p-6">
            <h2 class="text-xl font-bold text-black dark:text-white mb-3 flex items-center gap-2">
                <Icon name="material-symbols:group" class="text-[1.5rem] text-[var(--primary)]"></Icon>
                <span><I18n key={Translation.RecentSponsors} /></span>
            </h2>
            <div class="mb-4">
                <LinkSubmitInfo dataType="sponsors"></LinkSubmitInfo>
            </div>
            <div class="sponsors-grid">
                {sponsors.map((sponsor) => (
                    <div class="sponsor-card">
                        <div class="flex items-center gap-3 p-4 rounded-lg bg-[var(--card-bg)] border border-black/10 dark:border-white/10 backdrop-blur-md">
                            <div class="w-10 h-10 rounded-lg flex items-center justify-center overflow-hidden">
                            {sponsor.avatar ? (
                                <div class="relative w-full h-full rounded-lg overflow-hidden" style={`--theme-hue: ${siteConfig.themeColor.hue}`}>
                                    <img src={sponsor.avatar} alt={sponsor.name} loading="lazy" class="w-full h-full object-cover transition duration-500" />
                                </div>
                            ) : (
                                <Icon name="material-symbols:person" class="text-gray-500 dark:text-gray-400 text-[1.2rem]" />
                            )}
                        </div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-black dark:text-white text-sm">{sponsor.name}</h4>
                                <p class="text-xs text-black/60 dark:text-white/60">{sponsor.date}</p>
                            </div>
                            <div class="text-xs text-[var(--primary)] font-medium">{sponsor.amount}</div>
                        </div>
                    </div>
                ))}
            </div>
        </div>
    </div>
</MainGridLayout>

<style>
.donate-card {
    @apply bg-[var(--card-bg)] border border-black/10 dark:border-white/10 backdrop-blur-md flex flex-col p-4 rounded-lg transition;
}

.support-card {
    @apply border border-black/10 dark:border-white/10 hover:border-black/20 dark:hover:border-white/20 hover:bg-black/5 dark:hover:bg-white/5 transition p-4 rounded-lg;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

.qr-code-placeholder {
    @apply text-center;
}

.sponsors-section {
    @apply mt-6;
}

.sponsors-grid {
    @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4;
}

.sponsor-placeholder {
    @apply transition-all duration-200 hover:scale-105;
}

.sponsor-card {
    @apply transition-all duration-200 hover:shadow-md hover:scale-105;
}
</style>
