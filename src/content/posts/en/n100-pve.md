---
title: "N100 - PVE (fnOS + Debian) Infrastructure Record"
description: "Install PVE on the N100 mini PC, then install Feinu NAS and Debian within it to achieve separation of anime tracking and website hosting, while ensuring easy scalability and migration."
category: "Record"
draft: false
image: ../../assets/images/N100-PVE_cover.webp
lang: en
published: 2024-10-28
tags:
- PVE
---
:::ai-summary[AI Summary]{model="qwen/qwen3-vl-8b"}
This guide outlines setting up Proxmox VE (PVE) on an N100 mini PC, installing fnOS as a NAS with direct access to the CPU's integrated graphics and a 512GB SATA HDD for anime tracking, and installing Debian for running QQBot, a blog, and AList. It includes detailed steps for PVE installation, Realtek R8168 driver setup, network bridging, and configuring STUN via Lucky for external access. The process also covers using Ventoy for bootable media and custom scripts to streamline PVE management.
:::

# Configuration & Requirements

- N100 CPU Frequency: Minimum 700 MHz, Maximum 3400 MHz | TDP: 6 W

- 8G RAM

- 128G M.2 NVMe SSD

- 512G SATA HDD

- Realtek R8168 Ethernet Network Card

- USB wired network card

- USB drive (as a PVE boot disk)

# Objective

1. All systems are managed through PVE.

2. Install fnOS under PVE to function as a NAS and configure automatic anime tracking (direct passthrough: `N100 integrated graphics` `512G SATA HDD` )

3. Install Debian under PVE, set up QQBot, a blog, and AList

* **

# 1\. PVE

## Install

- Download the latest executable file of Ventoy:

[https://www.ventoy.net/cn/download.html](https://www.ventoy.net/cn/download.html)

- Use GPT partition table, NTFS format to write Ventoy to the USB drive

- Download the latest PVE ISO (using the USTC mirror source):

[https://mirrors.ustc.edu.cn/help/proxmox.html](https://mirrors.ustc.edu.cn/help/proxmox.html)

- Place the PVE ISO file in the root directory of the USB drive

- Insert the USB network card and USB drive into the N100, boot from the USB drive, enter the PVE installation interface, and install PVE. For network configuration, select the USB network card.

- Reboot, enter PVE, access the WebUI via IP:8006, and log in.

## Configuration

### Install PVE Quick Management Script

- Install the PVE quick management script: [pve_source.tar.gz | AcoFork-AList](https://alist.onani.cn/pve_source.tar.gz) or [[L:**https://wwp.lanzoul.com/ivHta1ngmo6d** (password: i1ws) (from: Below Mo Teacher)

- Extract: `tar zxvf pve_source.tar.gz`

- Run: `./pve_source`

- Agree to the license agreement

  - 依次执行白框操作![](../../assets/images/ea205e1a00e7029dfa4bd7850c5a6a68d6d4c0d9.webp)

- Expand local: `lvextend -rl +100%FREE /dev/pve/root`

### Configure Realtek R8168 network card

> Since Debian-based systems default to installing the R8169 driver, we need to manually install the R8168 driver; otherwise, we won't be able to use the wired Ethernet port on the N100 mini PC for internet access.

- Download driver:

  [https://www.realtek.com/Download/List?cate\_id=584](https://www.realtek.com/Download/List?cate_id=584)![](../../assets/images/0d8457c7fb0d497e12e2c8b544f07c3c37cf96cd.webp)

- Extract and install: `sh autorun.sh`

- Check for any new network interfaces: `ip a`

- ```shell
  root@n100-pve:~# ip a
  ...
  2: enp3s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq master vmbr1 state UP group default qlen 1000
      link/ether 00:e0:4c:08:91:a6 brd ff:ff:ff:ff:ff:ff
  ...
  ```

- Configure the network configuration file: `nano /etc/network/interfaces`

  ```
  # network interface settings; autogenerated
  # Please do NOT modify this file directly, unless you know what
  # you're doing.
  #
  # If you want to manage parts of the network configuration manually,
  # please utilize the 'source' or 'source-directory' directives to do
  # so.
  # PVE will preserve these directives, but will NOT read its network
  # configuration from sourced files, so do not attempt to move any of
  # the PVE managed interfaces into external files!
  
  auto lo
  iface lo inet loopback
  
  iface wlp1s0 inet manual
  
  iface enp3s0 inet manual
  
  auto vmbr1
  iface vmbr1 inet static
          address 192.168.124.25/24
          gateway 192.168.124.1
          bridge-ports enp3s0
          bridge-stp off
          bridge-fd 0
  
  iface vmbr1 inet6 auto
          dhcp 1
          accept_ra 2
          request_prefix 1
  
  source /etc/network/interfaces.d/*
  ```

- Restart the network service: `systemctl restart networking`

- View IP: `ip a`

  ```shell
  root@n100-pve:~# ip a
  ...
  2: enp3s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq master vmbr1 state UP group default qlen 1000
      link/ether 00:e0:4c:08:91:a6 brd ff:ff:ff:ff:ff:ff
  ...
  4: vmbr1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000
      link/ether 00:e0:4c:08:91:a6 brd ff:ff:ff:ff:ff:ff
      inet 192.168.124.25/24 scope global vmbr1
         valid_lft forever preferred_lft forever
      inet6 2409:8a30:320:7fc0:2e0:4cff:fe08:91a6/64 scope global dynamic mngtmpaddr
         valid_lft 2763sec preferred_lft 2762sec
      inet6 fe80::2e0:4cff:fe08:91a6/64 scope link
         valid_lft forever preferred_lft forever
  ```

- Remove USB network card

### Configure STUN tunneling

#### Set the router's DMZ host to the PVE IP

- ![](../../assets/images/dbeb7980e5fc699c696ffa6f2fda4a17c05ee821.webp)

#### Install Lucky

- Execute: `curl -o /tmp/install.sh http://6.666666.host:6/files/golucky.sh && sh /tmp/install.sh http://6.666666.host:6/files 2.13.4`

- Enter the Lucky backend via `host:16601` and configure STUN tunneling

- ![](../../assets/images/2175839424184aee880b91382bd1fbf3c578d258.webp)

# 2\. fnOS

## Install

- Go to the official website to download the latest ISO:

[https://www.fnnas.com/](https://www.fnnas.com/)

- 上传至PVE：![](../../assets/images/073808516d357e099a866c30b4a77954c5b9b458.webp)

- Create the fnOS virtual machine, select host as the CPU type, steps omitted.

- 直通核显和硬盘：![](../../assets/images/08e4f7a3b87ae86334011e1d4c3a384a36ad9866.webp)

- If you don't know the PCI ID of your integrated graphics and SATA controller: `lspci`

- The integrated graphics are at `00:02.0`, and the SATA controller is at `00:17.0`

    ```shell
    root@n100-pve:~# lspci
    00:00.0 Host bridge: Intel Corporation Device 461c
    00:02.0 VGA compatible controller: Intel Corporation Alder Lake-N [UHD Graphics]
    00:0a.0 Signal processing controller: Intel Corporation Platform Monitoring Technology (rev 01)
    00:14.0 USB controller: Intel Corporation Alder Lake-N PCH USB 3.2 xHCI Host Controller
    00:14.2 RAM memory: Intel Corporation Alder Lake-N PCH Shared SRAM
    00:16.0 Communication controller: Intel Corporation Alder Lake-N PCH HECI Controller
    00:17.0 SATA controller: Intel Corporation Alder Lake-N SATA AHCI Controller
    00:1a.0 SD Host controller: Intel Corporation Device 54c4
    00:1c.0 PCI bridge: Intel Corporation Device 54be
    00:1d.0 PCI bridge: Intel Corporation Alder Lake-N PCI Express Root Port
    00:1d.1 PCI bridge: Intel Corporation Alder Lake-N PCI Express Root Port
    00:1e.0 Communication controller: Intel Corporation Alder Lake-N Serial IO UART Host Controller
    00:1e.3 Serial bus controller: Intel Corporation Device 54ab
    00:1f.0 ISA bridge: Intel Corporation Alder Lake-N PCH eSPI Controller
    00:1f.3 Audio device: Intel Corporation Alder Lake-N PCH High Definition Audio Controller
    00:1f.4 SMBus: Intel Corporation Alder Lake-N SMBus
    00:1f.5 Serial bus controller: Intel Corporation Alder Lake-N SPI (flash) Controller
    01:00.0 Network controller: Intel Corporation Wireless 3160 (rev 83)
    02:00.0 Non-Volatile memory controller: Realtek Semiconductor Co., Ltd. RTS5765DL NVMe SSD Controller (DRAM-less) (rev 01)
    03:00.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL8111/8168/8411 PCI Express Gigabit Ethernet Controller (rev 2b)
    ```

- Start the virtual machine and install fnOS

## Configuration

- 前往飞牛设置，创建储存空间，Linear模式，选择刚才直通的硬盘![](../../assets/images/581cf01462df545a8662acbb5e20e1676bd17744.webp)

- 前往飞牛应用中心安装qBittorrent、影视，并且在设置给予目录读取权限![](../../assets/images/92a2e0bf25d630db4858775fdbb6c907f419c25d.webp)

- Configure the username and password for qBittorrent

- Open Feiniu Docker and initialize

- Pull and run the AutoBangumi Docker image:

  ```shell
  docker run -d \
  --name=AutoBangumi \
  -v /vol1/1000/AutoBangumi/config:/app/config \
  -v /vol1/1000/AutoBangumi/data:/app/data \
  -p 7892:7892 \
  -e TZ=Asia/Shanghai \
  -e PUID=$(id -u) \
  -e PGID=$(id -g) \
  -e UMASK=022 \
  --network=bridge \
  --dns=8.8.8.8 \
  --restart unless-stopped \
  ghcr.onani.cn/estrellaxd/auto_bangumi:latest
  ```

- 进入`host:7892` 让AutoBangumi连接qBittorrent并配置下载地址![](../../assets/images/82c4a003d2399f82a7ccf5849cd1d5858d5f1f61.webp)

- Add RSS. You can obtain the RSS feeds for various subtitle groups at [Mikan Project - Mikan Project](https://mikanime.tv/).

  ![](../../assets/images/f36daae968d8043bbcd1e4a2bbb9b9cd2d707cee.webp)

Note: When using [Mikan Project - Mikan Project](https://mikanime.tv/), please subscribe to the RSS feed of a single subtitle group, do not use personal RSS feeds, as this will result in **only receiving the latest episode of all your followed anime instead of all episodes of individual anime**.

- 打开飞牛影视，初始化并设置媒体库![](../../assets/images/269b78c3b7dffe7f8cdb861098f44147552b5eb4.webp)

- Note: If you want to scrape old episodes, please rename them properly; you can use automation tools: [Episode-ReName.zip | AcoFork-AList](https://alist.onani.cn/Episode-ReName.zip)

- Primary directory: That is the qb download directory, no renaming required

- Second-level directory: Anime title

- Third-level directory: Season, such as `Season 1`

- Fourth-level directory: episodes and subtitles, such as `S01E01.mp4` `S01E01.chs.ass`

# 3\. Debian

## Install

- Download the Debian 12 ISO (USTC mirror source) (recommended to choose the DVD image, which includes more packages and installs faster)

[https://mirrors.ustc.edu.cn/help/debian-cd.html](https://mirrors.ustc.edu.cn/help/debian-cd.html)

- Upload to PVE, create a Debian virtual machine, select host as the CPU type, steps omitted.

### Install 1Panel:

[https://1panel.cn/docs/installation/online_installation/](https://1panel.cn/docs/installation/online_installation/)

- Installing `Openresty` `MySQL` `Halo` `AList` `Cloudflared` in 1Panel; configuration steps omitted

### Building QQBot

#### Installation of OneBot v11 protocol implementation: Lagrange.OneBot

- Docker Run: `docker run -td -p 8081:8081 -v /root/qqbot/lo:/app/data -e UID=$UID -e GID=$(id -g) ghcr.onani.cn/lagrangedev/lagrange.onebot:edge`

- Modify the configuration file: `appsettings.json`

  ```json
  {
      "Logging": {
          "LogLevel": {
              "Default": "Information",
              "Microsoft": "Warning",
              "Microsoft.Hosting.Lifetime": "Information"
          }
      },
      "SignServerUrl": "",
      "SignProxyUrl": "",
      "MusicSignServerUrl": "",
      "Account": {
          "Uin": 0,
          "Password": "",
          "Protocol": "Linux",
          "AutoReconnect": true,
          "GetOptimumServer": true
      },
      "Message": {
          "IgnoreSelf": true,
          "StringPost": false
      },
      "QrCode": {
          "ConsoleCompatibilityMode": false
      },
      "Implementations": [
          {
              "Type": "ReverseWebSocket",
              "Host": "192.168.124.34",
              "Port": 9090,
              "Suffix": "/onebot/v11/ws",
              "ReconnectInterval": 5000,
              "HeartBeatInterval": 5000,
              "AccessToken": ""
          }
      ]
  }
  ```

- Restart the container, scan to log in

#### Install NoneBot2

- Install pip: `apt install python3-pip`

- Configure pip USTC source: `pip config set global.index-url https://mirrors.ustc.edu.cn/pypi/simple`

- Install pipx: `apt install pipx`

- Install nb-cli: `pipx install nb-cli`

- Set the pipx variable: `pipx ensurepath`

- Install nb bootstrap: `nb self install nb-cli-plugin-bootstrap`

- Create a new NoneBot2 project: `nb bs`

- ```
  root@n100-debian:~# nb bs
  加载适配器列表中……
  请输入项目名称
  [?] 请输入 > onani
  [?] 请选择你想要使用的适配器 OneBot V11 (OneBot V11 协议)
  请输入 Bot 超级用户，超级用户拥有对 Bot 的最高权限（如对接 QQ 填 QQ 号即可）（留空回车结束输入）
  [?] 第 1 项 > 666
  [?] 第 2 项 >
  请输入 Bot 昵称，消息以 Bot 昵称开头可以代替艾特（留空回车结束输入）
  [?] 第 1 项 >
  请输入 Bot 命令起始字符，消息以起始符开头将被识别为命令，
  如果有一个指令为 查询，当该配置项中有 "/" 时使用 "/查询" 才能够触发，
  留空将使用默认值 ['', '/', '#']（留空回车结束输入）
  [?] 第 1 项 >
  请输入 Bot 命令分隔符，一般用于二级指令，
  留空将使用默认值 ['.', ' ']（留空回车结束输入）
  [?] 第 1 项 >
  请输入 NoneBot2 监听地址，如果要对公网开放，改为 0.0.0.0 即可
  [?] 请输入 > 0.0.0.0
  请输入 NoneBot2 监听端口，范围 1 ~ 65535，请保证该端口号与连接端配置相同，或与端口映射配置相关
  [?] 请输入 > 9090
  [?] 是否在项目目录中释出快捷启动脚本？ Yes
  [?] 是否将 localstore 插件的存储路径重定向到项目路径下以便于后续迁移 Bot？ Yes
  [?] 是否使用超级用户 Ping 指令回复插件？ Yes
  [?] 是否安装 logpile 插件提供日志记录到文件功能？ Yes
  [?] 是否在启动脚本中使用 webui 插件启动项目以使用网页管理 NoneBot？（该插件仍在开发中，不推荐用于生产环境） No
  成功新建项目 onani
  [?] 是否新建虚拟环境？ Yes
  正在 /root/onani/.venv 中创建虚拟环境
  创建虚拟环境成功
  [?] 是否需要修改或清除 pip 的 PyPI 镜像源配置？ No
  [?] 是否立即安装项目依赖？ Yes
  正在安装项目依赖
  依赖安装成功
  [?] 请选择需要启用的内置插件
  项目配置完毕，开始使用吧！
  ```

# Exhibition of Achievements (Domain has been discontinued)

![](../../assets/images/4b4680cc548e0c59ec18cef537c9b1f5412fbbcd.webp)

[https://blog.onani.cn](https://blog.onani.cn)

[https://alist.onani.cn](https://alist.onani.cn)

![](../../assets/images/7c24ff7d54b2e0ccaecce4b2ef79155c54124fa4.webp)