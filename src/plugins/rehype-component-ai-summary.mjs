/// <reference types="mdast" />
import { h } from "hastscript";

/**
 * Creates an AI summary component.
 *
 * @param {Object} properties - The properties of the component.
 * @param {string} [properties.model] - The model used to generate the summary.
 * @param {import('mdast').RootContent[]} children - The children elements of the component.
 * @returns {import('mdast').Parent} The created AI summary component.
 */
export function AISummaryComponent(properties, children) {
	if (!Array.isArray(children) || children.length === 0)
		return h(
			"div",
			{ class: "hidden" },
			'Invalid AI summary directive.',
		);

	const model = properties?.model || "AI Model";
	
	let label = "AI 总结";
	if (properties?.["has-directive-label"]) {
		const labelNode = children[0];
		// biome-ignore lint/style/noParameterAssign: <explanation>
		children = children.slice(1);
		if (labelNode && labelNode.children && labelNode.children[0]) {
			label = labelNode.children[0].value;
		}
	}

	return h("div", { class: "ai-summary-card" }, [
		h("div", { class: "ai-summary-header" }, [
			h("span", { class: "ai-summary-icon" }, [
				h("svg", { width: "20", height: "20", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", "stroke-width": "2", "stroke-linecap": "round", "stroke-linejoin": "round" }, [
					h("path", { d: "M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z" }),
					h("path", { d: "M12 6v6l4 2" })
				])
			]),
			h("span", { class: "ai-summary-title" }, label),
		]),
		h("div", { class: "ai-summary-content" }, children),
		h("div", { class: "ai-summary-footer" }, [
			h("span", { class: "ai-summary-model-label" }, "Generated by:"),
			h("span", { class: "ai-summary-model-name" }, model),
		])
	]);
}
